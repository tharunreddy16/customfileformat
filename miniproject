CREATE DATABASE BATCH_12;
CREATE SCHEMA MINI_PROJECT;

CREATE OR REPLACE FILE FORMAT MY_CSV_FORMAT
  TYPE = CSV
  FIELD_DELIMITER = '|'
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  ;


CREATE TABLE STUDENT_TABLE
  (
     STUDENT_ID      NUMBER,
     NAME_NAME    VARCHAR,
     STUDENT_PLACE   VARCHAR,
     COUNTRY VARCHAR
  );   

CREATE
OR
REPLACE STAGE MY_STAGE;

COPY INTO STUDENT_TABLE FROM @MY_STAGE/B12.txt
FILE_FORMAT = (FORMAT_NAME = MY_CSV_FORMAT); 

select * from STUDENT_TABLE;

CREATE OR REPLACE FILE FORMAT MY_CSV_FORMAT_2
  TYPE = CSV
  FIELD_DELIMITER = ','
  SKIP_HEADER = 1
  NULL_IF = ('NULL', 'null')
  EMPTY_FIELD_AS_NULL = TRUE
  ;

COPY INTO STUDENT_TABLE FROM @MY_STAGE/B12_2.txt
FILE_FORMAT = (FORMAT_NAME = MY_CSV_FORMAT_2);   

select * from STUDENT_TABLE;
